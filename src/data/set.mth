module(data.set)

import(prelude)
import(data.bag)

||| A set is a bag without duplicates. It's stored as
||| sorted list, where items are strictly increasing.
data(Set(v), SET -> Bag(v))

def(unSET, Set(v) -- Bag(v), SET -> id)
def(set-nil, Set(v), bag-nil SET)
def(set-snoc, Set(v) v -- Set(v), dip(unSET) bag-replace SET)
def(set-cons, v Set(v) -- Set(v), swap set-snoc)
def(set-has, v Set(v) -- Bool, SET -> swap bag-has)
