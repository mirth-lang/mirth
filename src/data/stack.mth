module(data.stack)
import(prelude)

data(Stack(t), STACK_NIL, STACK_CONS -> t Stack(t))

def(stack-push, t Mut(Stack(t)) --,
    tuck @ STACK_CONS swap !)
def(stack-pop, Mut(Stack(t)) -- Maybe(t),
    dup @ match(
        STACK_NIL -> drop NONE,
        STACK_CONS -> rotl ! SOME
    ))
def(stack-is-empty, Mut(Stack(t)) -- Bool,
    @ is-nil)
