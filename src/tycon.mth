module(mirth.tycon)

import(std.prelude)
import(std.maybe)

import(mirth.name)
import(mirth.data)
import(mirth.table)
import(mirth.type)
import(mirth.mirth)

data(Tycon,
    TYCON_DATA -> Data,
    TYCON_TABLE -> Table,
    TYCON_PRIM -> PrimType)

def(Tycon.name, +Mirth Tycon -- +Mirth Name,
    TYCON_DATA -> name,
    TYCON_TABLE -> qname name,
    TYCON_PRIM -> tycon-qname name)
def(Tycon.qname-soft, +Mirth Tycon -- +Mirth Maybe(QName),
    TYCON_DATA -> qname-soft,
    TYCON_TABLE -> qname Some,
    TYCON_PRIM -> tycon-qname Some)
def(Tycon.qname-hard, +Mirth Tycon -- +Mirth QName,
    TYCON_DATA -> qname-hard,
    TYCON_TABLE -> qname,
    TYCON_PRIM -> tycon-qname)

def(Tycon.==, Tycon Tycon -- Bool,
    TYCON_DATA -> swap match(TYCON_DATA -> ==, _ -> drop2 False),
    TYCON_TABLE -> swap match(TYCON_TABLE -> ==, _ -> drop2 False),
    TYCON_PRIM -> swap match(TYCON_PRIM -> ==, _ -> drop2 False))

def(Tycon.>Type, Tycon -- Type,
    TYCON_DATA -> TData,
    TYCON_TABLE -> TTable,
    TYCON_PRIM -> TPrim)
