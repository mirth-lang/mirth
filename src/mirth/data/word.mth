module(mirth.data.word)

import(prelude)
import(data.map)
import(data.lazy)
import(data.maybe)
import(mirth.data.var)
import(mirth.data.name)

table(Word)
field(word-name, Word, Name)
field(word-head, Word, Token)
field(word-sig, Word, Maybe(Token))
field(word-body, Word, Token)
field(word-ctx-type, Word, Lazy([Ctx Type]))
field(word-params, Word, Lazy(List(Param)))
field(word-arrow, Word, Lazy(Arrow))

def(word-new!, Token Token Name -- Word,
    Word.alloc!
    dup2 DEF_WORD swap name-def !
    tuck word-name !
    tuck word-head !
    tuck word-body !
    NONE over word-sig !)
