module(tests/pack-unpack)
import(prelude)

def(mk-int-pack, [Int Int], 10 20 pack2)
def(swap-int-pack, [a b] -- [b a], unpack2 swap pack2)
def(sub-int-pack, [Int Int] -- Int, unpack2 -)
def(main, --,
    mk-int-pack
    dup unpack2 20 !!= 10 !!=
    swap-int-pack
    dup unpack2 10 !!= 20 !!=
    swap-int-pack
    dup unpack2 20 !!= 10 !!=
    sub-int-pack
    -10 !!=)
target-c99("pack-unpack.c", main)
