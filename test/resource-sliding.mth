module test.resource-sliding

import std.prelude
import std.world

struct +Foo {
    --
    def hello-foo [ +World +Foo |- ] { "hello foo" rdip:print }
    def drop-foo [ +Foo -- ] { +Foo -> }
}
struct +Bar {
    --
    def hello-bar [ +World +Bar |- ] { "hello bar" rdip:print }
    def drop-bar [ +Bar -- ] { +Bar -> }
}

def foo-first [ +Foo +Bar |- ] { }
def bar-first [ +Bar +Foo |- ] { }

def foo-bar [ +Foo +Bar |- ] {
    foo-first
    bar-first
    foo-first
}

def auto-rearrange [ +Foo +Bar -- +Bar +Foo ] { }

def main [ +World -- +World ] {
    +Foo +Bar
    drop-foo
    drop-bar
}
# mirth-test # merr # 30:5: error: Failed to unify +Bar with +Foo
# mirth-test # merr # 31:5: error: Method test.resource-sliding.+Bar.drop-bar does not match [+World +Foo]
# mirth-test # mret # 1
